<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LitComponent TESTING</title>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <script src="./index.js" type="module"></script>
    <style>
      body {
        font-family: sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        gap: 40px;
        background-color: whitesmoke;
      }
    </style>
  </head>
  <body>
    <cart-component id="cart"></cart-component>

    <product-component
      img="../assets/miku_peluche.png"
      name="Peluche Miku"
      price="20.00"
      discount="10"
      rating="5"
    ></product-component>
    <product-component
      img="../assets/chessboard.png"
      name="Tablero Ajedrez"
      price="100.00"
      rating="4"
    ></product-component>
  </body>
  <script>
    const cart = document.querySelector("#cart");

    function addToCart(event) {
      cart.addProduct(event.detail);
    }

    const products = document.querySelectorAll("product-component");
    products.forEach((product) => {
      product.addToCart = addToCart;
    });


    // fetch('https://fakestoreapi.com/products/1').then(res=>res.json()).then(json=>console.log(json))

    // print the json
    async function getProducts(){
      // buscarse una api que entregue imagenes png en vez de jpg
      const response = await fetch('https://fakestoreapi.com/products');
      const json = await response.json();
      if (response.ok) {
        return json.map((product) => addProductToStore(product));
      } else {
        console.log('error');
      }
      return [];
    }
    getProducts();

    function addProductToStore(product) {
      const productComponent = document.createElement("product-component");
      productComponent.setAttribute("img", product.image);
      productComponent.setAttribute("name", product.title);
      productComponent.setAttribute("price", product.price);
      productComponent.setAttribute("rating", product.rating.rate);
      productComponent.addToCart = addToCart;
      document.body.appendChild(productComponent);
    }

    // getProducts().map((product) => addProductToStore(product));


  </script>
</html>
